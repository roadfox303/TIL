### migration で integer ⇄ boolean の型変換
- default値が設定されていると変換できず下記のようなエラーが発生する。
  - PG::DatatypeMismatch: ERROR:  default for column "intrust" cannot be cast automatically to type boolean
- そこで下記のようなマイグレーションにするとうまくいく。
  1. まず not null 制約を外す
  2. default値　を nil にする。
  3. 型変換（null制約つけるならここで。この時点で default値のオプションを付けると失敗する）
  4. default値を設定
- すでにレコードに値がある場合は、たぶん、一時待避用のカラムを作成して保管、値を型に応じて変換してから各レコードに移植するなどしないといけないと思う。(上手いやり方調べる必要あり)

```
class ChangeDatatypeIntrustOfPets < ActiveRecord::Migration[5.2]
  def up
    change_column_null :pets, :intrust, null: true
    change_column_default :pets, :intrust, nil
    change_column :pets, :intrust, 'boolean USING CAST(intrust AS boolean)', null: false
    change_column_default :pets, :intrust, false
  end
  def down
    change_column_null :pets, :intrust, null:true
    change_column_default :pets, :intrust, nil
    change_column :pets, :intrust, 'integer USING CAST(intrust AS integer)', null: false
    change_column_default :pets, :intrust, 0
  end
end
```
