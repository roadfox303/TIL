# もう怖くないGit
### Gitはファイルのバージョンを管理するために使う
- ファイルのバージョンを管理しないと、複数人の場合最新のファイルがわからず、上書きなどのトラブルが起こってします。
- いつ、誰が、何を更新したか
- どのファイルの何が編集されたか
- 上書きしようとすると警告が出る。

### Gitの歴史
- リーナス・トーバルス
- Linuxカーネル開発で使用していたバージョン管理システムが使えなくなって、開発された。
  - 大規模プロジェクトを効率的に開発できる。
  - スピード
  - シンプルな設計
  - ブランチが並列で開発可能

### GitHub とは
- Gitでのファイルをオンラインで共有できるように開発された。
- プルリクエストによる複数人開発。
- 世界中のチームがGitHub上で開発。
- GitHub
  - 非公開リポジトリは有料
  - 公開リポジトリは無料
- BitBucket
  - 非公開リポジトリが無料
  - 人数制限があるが２、３人は無料
  - 小規模チームでの開発に向く

### Atom
- Githubの創業者が開発

### Git

##### Git command

```
# 設定一覧
git config --list

```

### gitの仕組み
- gitはスナップショット（差分ではなく全情報）を新規記録する。
- コミットを辿ると以前の状態(コミット)に戻れる。

- ローカル
  - ローカルリポジトリにスナップショットを記録
- GitHub
  - GitHub(リモートリポジトリ)にアップロード
|ローカルは３つのエリアに分かれている|
|:---:|:---:|
|リポジトリ|スナップショットを記録(git commit)|
|ステージ|コミットする変更を準備(git add)|
|ワークツリー|ファイルを変更する作業場|

### gitのしくみと基本コマンド
##### gitのデータの持ち方（コミットまでの流れ）
|コマンド|行われている処理|
|:---:|:---|
|git init|.gitディレクトリ(ローカルリポジトリ)が作成される。<br>.gitに圧縮ファイル、ツリーファイル、コミットファイル、インデックスファイル、設定ファイルが含まれる。<br>.git/objects に圧縮ファイルやツリーファイルコミットファイルが保存される。|
|git add|1. ステージに追加するファイル（A）の圧縮ファイル（A'）をリポジトリに保存する<br>2. (A')の内容は(A)というファイルですよというマッピング情報を記録したインデックスというファイルをステージに追加。|
|git commit|1. インデックスをもとにツリーというファイルを作成する。ツリーはインデックスに記録してあるファイルとディレクトリの構成を、リポジトリに作成したもの。<br>2. コミットというファイルをリポジトリに作成（コミットには対象となるツリーの情報、作成者、日付、コミットメッセージが記録される）|
|git add(ファイル追加)|同様|
|git commit(ファイル追加)|コミットには親コミット情報も記録される。|
|git add(ファイル変更)|変更したファイルのみ、リポジトリに圧縮ファイルが作成される。|

- git add や git commit で作成された圧縮ファイル、ツリーファイル、コミットファイルの事を、Gitでは **Gitオブジェクト** と呼んでいる。

- ツリーファイルはディレクトリ１つにつき１つ作成される。
- 1つのファイルに１つの圧縮ファイル。１つのディレクトリに１つのツリーファイル。

### GitHub上にあるプロジェクトから始める
|コマンド|行われている処理|
|:---:|:---|
|git clone|リモートリポジトリのファイルと、リポジトリがコピーされる。|

### コミットメッセージ
- 簡単に書くとき
  - 変更内容の要点と理由を一行で簡潔に書く。
- 正式に書く（チームでしっかりやる場合や、オープンソースに書くとき）
  - 1行目:変更内容の要約
  - 2行目:空白
  - 3行目:変更した内容

- 変更したファイルのみコミットする癖をつける。
  - ついつい add . しがちだが、git status で確認し必要なもののみ（変更途中のファイルなどは除いて）addする。
  - git status は ステージにaddしたインデックスと、前回ステージに追加して変更したワークツリー(リポジトリにある前回コミット内のツリーオブジェクト)を比較した結果を表示している。

### ステージに追加する前にどんな変更をしたのか確認する
- 変更差分を確認する。
  - git add　する前。
    - git diff
    - git diff ファイルネーム (特定のファイルを指定する場合)
  - git add したあと。
    - git diff --staged

### 変更履歴を確認する
- git log
- git log --oneline
  - 一行で要点のみ表示する。
- git log -p ファイル名
  - 特定ファイルの差分のみ表示
- git log -n コミット数
  - 直近のコミットのみ表示

### ファイルの削除を記録
- ファイルの削除を記録するには、git add とは別のコマンドを使う必要がある。
- ローカルファイルごと削除（リポジトリとローカルのファイル両方消える）
  - git rm ファイル名
  - git rm -r ディレクトリ名
- ローカルファイルを残したいとき(ワークツリーにファイルを残し、リポジトリからだけ消したい場合)
  - git rm --cached ファイル名

### ファイルの移動を記録
- git mv 旧ファイル名 新ファイル名
  - 下記のコマンドを全て実行したのと同じ結果
  - mv 旧ファイル 新ファイル
  - git rm 旧ファイル
  - git add 新ファイル

### push
- git push -u origin master
  - -u　オプションをつけると、次回から git push のみで origin master にプッシュできる。

### コマンドにエイリアスをつける
- コマンドを省略できる。
- git config --global alias.ci commit
  - git ci　でコミットできるようになる。(--global をつけることによってPC全体で有効な設定になる。)
- git config --global alias.st status
- git config --global alias.br branch
- git config --global alias.co checkout

### ワークツリーのファイルへの変更を取り消す
- git checkout -- ファイル名
- git checkout -- ディレクトリ名
- git checkout -- . (全ファイル)
- ステージの情報を取得してワークツリーへ反映する。

### ステージした変更を取り消す
- git reset HEAD ファイル名
- gir teset HEAD ディレクトリ名
- git reset HEAD . (全変更を取り消す)
- ステージから取り消すだけなので、ワークツリーのファイルには影響を与えない。
- リポジトリから直前のコミットを取得してきて、ステージの内容に上書きしている。
- HEAD とは 自分がいるブランチの最新のコミット

### 直前のコミットをやりなおし(ローカルリポジトリの場合)
- git commit --amend
- 今のステージの内容で直前のコミットを上書きする
- リモートにプッシュしたコミットについてはやり直してはいけない！

### リモートの情報を確認する
- リモートリポジトリの情報(名前)を表示する。
  - git remote
- リモートのURLを表示
  - git remote -v

### リモートリポジトリを新規追加
- リモートリポジトリは複数登録できる。
- git remote add リモート名 リモートURL

### リーモートから情報を取得する（fetch）
- git fetch リモート名
  - git fetch origin
- リモートからローカルリポジトリの下記のブランチに取得している。
  - remotes/リモート/ブランチ
- git merge ワークツリーにマージする。
  - git merge origin/master (origin/master の情報をワークツリーに統合という意味)

### リーモートから情報を取得する（pull）
- リモートから情報を取得してマージまで一度にやりたいとき
- git pull リモート名 ブランチ名
  - git pull　（リモート名、ブランチは省略可能※remote master　と同じになる。）
- git pull　は 下記の二つのコマンドと同じ事
  - git fetch origin master
  - git merge origin/master
